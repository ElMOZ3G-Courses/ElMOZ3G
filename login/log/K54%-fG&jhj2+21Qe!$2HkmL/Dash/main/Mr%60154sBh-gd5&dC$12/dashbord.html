<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="script/dash-style.css">
</head>
<body>
    <!-- Dashboard Container -->
    <div class="dashboard-container">
        <!-- Header -->
        <header class="header">
            <h1>Home</h1>
            <div class="user-profile">
                <span style="color: rgb(93, 39, 230);" class="span-name" id="username">John Doe</span>
                <img src="png/profile.png" alt="User  Profile">
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><a href="#" class="active">Home</a></li>
                    <li><a href="#">Analytics</a></li>
                    <li><a href="#">Reports</a></li>
                    <li><a href="#">Settings</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="cards">
                <div class="card">
                    <h2>Total Users</h2>
                    <p>1,234</p>
                </div>
                <div class="card">
                    <h2>Revenue</h2>
                    <p>$12,345</p>
                </div>
                <div class="card">
                    <h2>Active Projects</h2>
                    <p>15</p>
                </div>
            </div>

            <!-- Chart Placeholder -->
            <div class="chart">
                <h2 class="profileSection">Monthly Performance</h2>
                <canvas id="myChart"></canvas>
            </div>
        </main>
    </div>

    <!-- Firebase App and Database SDK -->
    <script src="https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js"></script>

    <!-- JavaScript for Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script/script.js"></script>
    <script type="module" src="script/firebase.js"></script>

    <script>
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";

        const firebaseConfig = {
        apiKey: "AIzaSyBLUTgSq6AOMV4zjT68MqZixxCtpLTpzrs",
        authDomain: "uplaod-web.firebaseapp.com",
        databaseURL: "https://uplaod-web-default-rtdb.firebaseio.com",
        projectId: "uplaod-web",
        storageBucket: "uplaod-web.appspot.com",
        messagingSenderId: "458250812436",
        appId: "1:458250812436:web:340df3066a4753d3f17b01",
        measurementId: "G-35BEH0W9NS"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getDatabase(app);

        // Check if the user is logged in
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                const userId = user.uid;

                // Fetch user data from the database
                firebase.database().ref('users/' + userId).once('value')
                    .then((snapshot) => {
                        const userData = snapshot.val();

                        // Display the username in the <span> element
                        const usernameSpan = document.getElementById('username');
                        usernameSpan.textContent = userData.username; // Update the span with the username
                    })
                    .catch((error) => {
                        console.error("Error fetching user data:", error);
                    });
            } else {
                console.log("User   is not logged in.");
            }
        });

        import { getAuth } from "firebase/auth";

        const auth = getAuth();
        const user = auth.currentUser;
        if (user !== null) {
        // The user object has basic properties such as display name, email, etc.
            const displayName = usernameSpan.displayName;
        }
    </script>
</body>
</html>
